<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/reskript/blog/rss.xml" title="reSKRipt Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/reskript/blog/atom.xml" title="reSKRipt Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="reSKRipt" href="/reskript/opensearch.xml"><title data-react-helmet="true">One post tagged with &quot;debug&quot; | reSKRipt</title><meta data-react-helmet="true" property="og:title" content="One post tagged with &quot;debug&quot; | reSKRipt"><meta data-react-helmet="true" property="og:url" content="https://ecomfe.github.io/reskript/blog/tags/debug"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-react-helmet="true" rel="shortcut icon" href="/reskript/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://ecomfe.github.io/reskript/blog/tags/debug"><link data-react-helmet="true" rel="alternate" href="https://ecomfe.github.io/reskript/blog/tags/debug" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://ecomfe.github.io/reskript/blog/tags/debug" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/reskript/assets/css/styles.7a0f85c1.css">
<link rel="preload" href="/reskript/assets/js/runtime~main.ae56f4e9.js" as="script">
<link rel="preload" href="/reskript/assets/js/main.59db0e6d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/reskript/"><img src="/reskript/images/logo.svg" alt="reSKRipt" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/reskript/images/logo.svg" alt="reSKRipt" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link" href="/reskript/docs/getting-started">文档</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/reskript/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ecomfe/reskript" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-tags-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/reskript/blog/v2-long-awaited">V2 - 望之如梅</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/reskript/blog/enable-deprecation-flag">用全局环境变量做好升级2.0的准备</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/reskript/blog/use-reflect-metadata">支持Reflect Metadata</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/reskript/blog/play-with-router">用skr play调试需要路由的组件</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/reskript/blog/svg-import-change">导入SVG文件规则调整</a></li></ul></nav></aside><main class="col col--7"><header class="margin-bottom--xl"><h1>One post tagged with &quot;debug&quot;</h1><a href="/reskript/blog/tags">View All Tags</a></header><article class="margin-bottom--xl"><header><h2 class="blogPostTitle_GeHD"><a href="/reskript/blog/play-with-router">用skr play调试需要路由的组件</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2021-08-03T00:00:00.000Z">August 3, 2021</time> · One min read</div><div class="avatar margin-vert--md"><a href="https://github.com/otakustay" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://www.gravatar.com/avatar/d7479a703555cc76b277040e5be9b8ca" alt="otakustay"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/otakustay" target="_blank" rel="noopener noreferrer">otakustay</a></div><small class="avatar__subtitle"></small></div></div></header><div class="markdown"><p>在使用<code>reSKRipt</code>的时候，我们非常推荐使用<a href="https://ecomfe.github.io/reskript/docs/advanced/debug-component" target="_blank" rel="noopener noreferrer">skr play命令</a>来调试单个组件，它会为你提供一个可实时编程的界面，实时看到对应组件的可交互界面。</p><p>但并不是每一个组件都纯粹到可以没有外部依赖就跑起来的，其中很典型的一种情况就是<strong>组件依赖了路由</strong>，例如我们需要用<code>useParams()</code>来获取URL中的参数，或使用<code>useLocation()</code>拿到具体的路径信息。由于<code>skr play</code>默认的调试环节是不具备路由等环境的，因此需要我们做一些额外的配置工作。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="目录结构"></a>目录结构<a class="hash-link" href="#目录结构" title="Direct link to heading">#</a></h2><p>我们假定正在开发一个<code>Foo</code>组件，它需要使用<code>react-router-dom</code>才能正常展示，那么可以有下面这样的目录结构：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/src</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /components</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        /Foo</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            /__repl__</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                index.play.js</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            index.tsx</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>其中<code>src/components/Foo/index.tsx</code>为组件的实现代码。我们可以看到这个结构中多了一个<code>src/components/Foo/__repl__/index.play.js</code>文件，这个被称为<code>skr play</code>的配置文件。这个文件的名字与组件文件名同名，如果你的组件文件名是<code>Bar.tsx</code>，那么它就是<code>__repl__/Bar.play.js</code>。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="注入外部依赖"></a>注入外部依赖<a class="hash-link" href="#注入外部依赖" title="Direct link to heading">#</a></h2><p>在<code>__repl__/index.play.js</code>中，我们可以编写以下内容：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports maybe-class-name">MemoryRouter</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;react-router-dom&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> provides </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token maybe-class-name">MemoryRouter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>可以看到，我们引用了<code>react-router-dom</code>中的<code>MemoryRouter</code>，并通过<code>export const provides</code>对象把它导了出去。</p><p>在配置文件中，<code>export const provides</code>导出可以将你需要的内容“带给”<code>skr play</code>的调试现场。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="使用依赖"></a>使用依赖<a class="hash-link" href="#使用依赖" title="Direct link to heading">#</a></h2><p>当你使用<code>skr play src/components/Foo/index.tsx</code>打开调试现场时，你看到的代码中依然没有<code>MemoryRouter</code>，此时你还是不能正确地看到组件的长相。你需要将左侧编辑器中的代码调整为这样：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jsx"><pre tabindex="0" class="prism-code language-jsx codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">Repl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">I.MemoryRouter</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">initialEntries</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token tag script language-javascript string" style="color:rgb(195, 232, 141)">&#x27;/foo/bar/123&#x27;</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">Foo</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">I.MemoryRouter</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>简单来说，所有你在配置文件的<code>provides</code>对象里提供的东西，都可以在界面中用<code>I.xxx</code>拿来用。</p><p>当然，为了调试方便，也可以把<code>Link</code>也提供出去，在调试界面里加几个链接来快速跳到某些URL下看效果。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="总结"></a>总结<a class="hash-link" href="#总结" title="Direct link to heading">#</a></h2><p>我们介绍了通过<code>__repl__/xxx.play.js</code>配置文件导出依赖给调试现场的方法，重点在于：</p><ol><li>有一个<code>__repl__/xxx.play.js</code>作为<code>skr play</code>的配置文件，与组件一一对应。</li><li>使用<code>export const provides</code>对象提供依赖。</li><li>在调试现场使用<code>I.xxx</code>使用依赖。</li></ol><p>除了路由，你也可以用相同的方法解决如<code>Context</code>等问题。</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><a class="margin-horiz--sm" href="/reskript/blog/tags/play">play</a><a class="margin-horiz--sm" href="/reskript/blog/tags/debug">debug</a><a class="margin-horiz--sm" href="/reskript/blog/tags/router">router</a></div><div class="col text--right"><a aria-label="Read more about 用skr play调试需要路由的组件" href="/reskript/blog/play-with-router"><b>Read More</b></a></div></footer></article></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/reskript/assets/js/runtime~main.ae56f4e9.js"></script>
<script src="/reskript/assets/js/main.59db0e6d.js"></script>
</body>
</html>