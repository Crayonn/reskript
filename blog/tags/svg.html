<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/reskript/blog/rss.xml" title="reSKRipt Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/reskript/blog/atom.xml" title="reSKRipt Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="reSKRipt" href="/reskript/opensearch.xml"><title data-react-helmet="true">One post tagged with &quot;svg&quot; | reSKRipt</title><meta data-react-helmet="true" property="og:title" content="One post tagged with &quot;svg&quot; | reSKRipt"><meta data-react-helmet="true" property="og:url" content="https://ecomfe.github.io/reskript/blog/tags/svg"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-react-helmet="true" rel="shortcut icon" href="/reskript/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://ecomfe.github.io/reskript/blog/tags/svg"><link data-react-helmet="true" rel="alternate" href="https://ecomfe.github.io/reskript/blog/tags/svg" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://ecomfe.github.io/reskript/blog/tags/svg" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/reskript/assets/css/styles.7a0f85c1.css">
<link rel="preload" href="/reskript/assets/js/runtime~main.9f249d14.js" as="script">
<link rel="preload" href="/reskript/assets/js/main.392716ba.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/reskript/"><img src="/reskript/images/logo.svg" alt="reSKRipt" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/reskript/images/logo.svg" alt="reSKRipt" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link" href="/reskript/docs/getting-started">文档</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/reskript/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ecomfe/reskript" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-tags-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/reskript/blog/play-with-router">用skr play调试需要路由的组件</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/reskript/blog/svg-import-change">导入SVG文件规则调整</a></li></ul></nav></aside><main class="col col--7"><header class="margin-bottom--xl"><h1>One post tagged with &quot;svg&quot;</h1><a href="/reskript/blog/tags">View All Tags</a></header><article class="margin-bottom--xl"><header><h2 class="blogPostTitle_GeHD"><a href="/reskript/blog/svg-import-change">导入SVG文件规则调整</a></h2><div class="blogPostData_291c margin-vert--md"><time datetime="2021-08-03T08:45:05.840Z">August 3, 2021</time> · One min read</div><div class="avatar margin-vert--md"><a href="https://github.com/otakustay" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://www.gravatar.com/avatar/d7479a703555cc76b277040e5be9b8ca" alt="otakustay"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/otakustay" target="_blank" rel="noopener noreferrer">otakustay</a></div><small class="avatar__subtitle"></small></div></div></header><div class="markdown"><p>在之前版本的<code>reSKRipt</code>中，你可以通过<code>ReactComponent</code>这一命名导出中获得一个SVG转换出来的组件：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jsx"><pre tabindex="0" class="prism-code language-jsx codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">ReactComponent </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> IconClose</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./close.svg&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">IconClose</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>从<code>reSKRipt v1.13.0</code>开始，这个规则将发生一些改变。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="背景"></a>背景<a class="hash-link" href="#背景" title="Direct link to heading">#</a></h2><p>在Webpack的发展历史上，<a href="https://github.com/webpack-contrib/url-loader" target="_blank" rel="noopener noreferrer">url-loader</a>是负责将一个资源转为一个引用它的URL的准官方工具。但随着<a href="https://webpack.js.org/guides/asset-modules/" target="_blank" rel="noopener noreferrer">新版本的Webpack支持asset module</a>，<code>url-loader</code>已经被官方标记为废弃了。</p><p>基于这一个技术的发展，原有的<a href="https://github.com/ecomfe/svg-mixed-loader" target="_blank" rel="noopener noreferrer">svg-mixed-loader</a>也不再能独立地发展。我在<a href="https://github.com/webpack/webpack/issues/13870" target="_blank" rel="noopener noreferrer">这个issue</a>中和Webpack官方进行了一系列的探讨，最终官方的意见是比较直白的：</p><blockquote><p>不要让loader去做这么复杂的事，应该在规则上区分它们，并用资源查询来处理。</p></blockquote><p>基于官方给出的意见，<code>reSKRipt</code>也计划做出相应的调整。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="调整后的使用方式"></a>调整后的使用方式<a class="hash-link" href="#调整后的使用方式" title="Direct link to heading">#</a></h2><p>如果你需要一个SVG为你提供URL字符串，则与原有保持一样。：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports">url</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./close.svg&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>如果你希望获得一个组件，需要调整代码：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">IconClose</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./close.svg?react&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>注意在最后增加了一个<code>?react</code>的查询。</p><p>如果你两者都要，那么你需要写2条<code>import</code>语句。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="在css中使用"></a>在CSS中使用<a class="hash-link" href="#在css中使用" title="Direct link to heading">#</a></h3><p>在之前的版本中，如果你在CSS中引入一个SVG文件，它大概率是不能工作的：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly css"><pre tabindex="0" class="prism-code language-css codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token selector class" style="color:rgb(199, 146, 234)">.root</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">background-image</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token url function" style="color:rgb(130, 170, 255)">url</span><span class="token url punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token url string url" style="color:rgb(221, 221, 221)">&quot;./background.svg&quot;</span><span class="token url punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>因为SVG被处理成了一个具备URL和组件代码的混合内容。为了保持向后兼容性，我们现在无法修改这个行为，但增加了一个方式让CSS可以直接引用图片：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly css"><pre tabindex="0" class="prism-code language-css codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token selector class" style="color:rgb(199, 146, 234)">.root</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">background-image</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token url function" style="color:rgb(130, 170, 255)">url</span><span class="token url punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token url string url" style="color:rgb(221, 221, 221)">&quot;./background.svg?asset&quot;</span><span class="token url punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>你需要在资源上增加一个<code>?asset</code>的查询，即告知<code>reSKRipt</code>你只需要它被转化为一个URL。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="废弃警告"></a>废弃警告<a class="hash-link" href="#废弃警告" title="Direct link to heading">#</a></h3><p>如果你现在依然使用原来的<code>ReactComponent</code>导出，你的代码将正常工作，但在浏览器的控制台中将看到一条类似的警告：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import {ReactComponent} from &#x27;*.svg&#x27; is deprecated, please use import ReactComponent from &#x27;*.svg?react&#x27; instead.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This warning emits because you imported {ReactComponent} from /path/to/filename.svg</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>这条警告仅在<code>development</code>模式下出现，你可以快速定位到相关的代码并进行修改。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="关于类型"></a>关于类型<a class="hash-link" href="#关于类型" title="Direct link to heading">#</a></h2><p>当然，现在的方式使得<code>.svg</code>文件随着查询的不同会呈现出不同的类型，因此我们的TypeScript定义也要相应调整：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">declare</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">module</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;*.svg&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">default</span><span class="token plain"> url</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">declare</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">module</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;*.svg?react&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports maybe-class-name">ComponentType</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">SVGAttributes</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token maybe-class-name">ComponentType</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token maybe-class-name">SVGAttributes</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token maybe-class-name">SVGElement</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">default</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>以上代码我们建议放到<code>src/types/static.d.ts</code>中。</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><a class="margin-horiz--sm" href="/reskript/blog/tags/build">build</a><a class="margin-horiz--sm" href="/reskript/blog/tags/svg">svg</a></div><div class="col text--right"><a aria-label="Read more about 导入SVG文件规则调整" href="/reskript/blog/svg-import-change"><b>Read More</b></a></div></footer></article></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/reskript/assets/js/runtime~main.9f249d14.js"></script>
<script src="/reskript/assets/js/main.392716ba.js"></script>
</body>
</html>